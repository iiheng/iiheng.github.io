---
title: 模拟登陆
date: 2022-03-10 01:33:19
tags:
---
## 前言
## 模拟登录的基本原理
## 基于Session 和 Cookie的模拟登录爬取实战
### 准备工作
### 案例介绍
### 模拟登录
```
import requests
from urllib.parse import urljoin

BASE_URL = 'https://login2.scrape.center/'
LOGIN_URL = urljoin(BASE_URL,'/login')
INDEX_URL = urljoin(BASE_URL,'/page/1')
USERNAME = 'admin'
PASSWORD = 'admin'

response_login = requests.post(LOGIN_URL,data={
    'username':USERNAME,
    "password":PASSWORD
},timeout=20)

response_index = requests.get(INDEX_URL)
print('Response Status',response_index.status_code)
print('Response URL',response_index.url)
```

```
import requests
from urllib.parse import urljoin

BASE_URL = 'https://login2.scrape.center/'
LOGIN_URL = urljoin(BASE_URL,'/login')
INDEX_URL = urljoin(BASE_URL,'/page/1')
USERNAME = 'admin'
PASSWORD = 'admin'

response_login = requests.post(LOGIN_URL,data={
    'username':USERNAME,
    "password":PASSWORD
},timeout=20,allow_redirects=False)


cookies = response_login.cookies
print('cookies',cookies)

response_index = requests.get(INDEX_URL,cookies=cookies)
print('Response Status',response_index.status_code)
print('Response URL',response_index.url)
```

	cookies <RequestsCookieJar[<Cookie sessionid=ti6lf7gtqs22795li4h6t71b25ixwrk5 for login2.scrape.center/>]>
	Response Status 200
	Response URL https://login2.scrape.center/page/1
	
```
import requests
from urllib.parse import urljoin

BASE_URL = 'https://login2.scrape.center/'
LOGIN_URL = urljoin(BASE_URL,'/login')
INDEX_URL = urljoin(BASE_URL,'/page/1')
USERNAME = 'admin'
PASSWORD = 'admin'

session = requests.Session()

response_login = session.post(LOGIN_URL,data={
    'username':USERNAME,
    "password":PASSWORD
},timeout=20)

cookies = session.cookies
print("Cookies",cookies)

response_index = session.get(INDEX_URL,cookies=cookies)
print('Response Status',response_index.status_code)
print('Response URL',response_index.url)
```

	Cookies <RequestsCookieJar[<Cookie sessionid=sbamun5sr64t80fxgiwovdf3jcua9kso for login2.scrape.center/>]>
	Response Status 200
	Response URL https://login2.scrape.center/page/1
	
```
import requests
from urllib.parse import urljoin
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By
import time

BASE_URL = 'https://login2.scrape.center/'
LOGIN_URL = urljoin(BASE_URL,'/login')
INDEX_URL = urljoin(BASE_URL,'/page/1')
USERNAME = 'admin'
PASSWORD = 'admin'

browser = webdriver.Chrome()
browser.get(BASE_URL)
browser.find_element(By.CSS_SELECTOR,'input[name="username"]').send_keys(USERNAME)
browser.find_element(By.CSS_SELECTOR,'input[name="password"]').send_keys(PASSWORD)
browser.find_element(By.CSS_SELECTOR,'input[type="submit"]').click()
time.sleep(10)

cookies = browser.get_cookies()
print('Cookies',cookies)
browser.close()

session = requests.Session()
for cookie in cookies:
    session.cookies.set(cookie['name'],cookie['value'])

response_index = session.get(INDEX_URL)
print('Response Status',response_index.status_code)
print('Response URL',response_index.url)
```


## 基于JWT的模拟登录爬取实战
### 准备工作
### 案例介绍
### 模拟登录
```
import requests
from urllib.parse import urljoin

BASE_URL = 'https://login3.scrape.center/'
LOGIN_URL = urljoin(BASE_URL,'/api/login')
INDEX_URL = urljoin(BASE_URL,'/api/book')
USERNAME = 'admin'
PASSWORD = 'admin'

response_login = requests.post(LOGIN_URL,json={
    'username':USERNAME,
    'password':PASSWORD
})

data = response_login.json()
print('Response JSON',data)
jwt = data.get('token')
print('JWT',jwt)

headers = {
    'Authorization':f'jwt {jwt}'
}

response_index = requests.get(INDEX_URL,params={
    'limit':18,
    'offset':0
},headers=headers)
print('Response Status',response_index.status_code)
print('Response URL',response_index.url)
print('Response Data',response_index.json())
```

	Response JSON {'token': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjQ2OTQwOTMxLCJlbWFpbCI6ImFkbWluQGFkbWluLmNvbSIsIm9yaWdfaWF0IjoxNjQ2ODk3NzMxfQ.0eBDWfVbePqgMEj5ZsoacvXxGV-NmXOgCA-pAGvawNU'}
	JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjQ2OTQwOTMxLCJlbWFpbCI6ImFkbWluQGFkbWluLmNvbSIsIm9yaWdfaWF0IjoxNjQ2ODk3NzMxfQ.0eBDWfVbePqgMEj5ZsoacvXxGV-NmXOgCA-pAGvawNU
	Response Status 200
	Response URL https://login3.scrape.center/api/book/?limit=18&offset=0
	Response Data {'count': 9200, 'results': [{'id': '34473697', 'name': 'R数据科学实战：工具详解与案例分析', 'authors': ['刘健'
	.....
	
## 大规模账号池的搭建
### 案例介绍
### 本节目标
### 准备工作
### 账号池的搭建
##### 存储模块
